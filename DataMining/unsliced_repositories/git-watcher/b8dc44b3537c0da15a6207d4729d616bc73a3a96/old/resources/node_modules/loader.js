var fs = require('fs');

var Loader = {
	loadConfig: function() {
		var configFile = require('path').normalize(__dirname + '/../config.json');
		config = fs.existsSync(configFile) ? JSON.parse(fs.readFileSync(configFile)) : {};
		this._replaceEnvVars(config);
		return config;
	},
	
	_replaceEnvVars: function(map) {
		for (var name in map) {
			if (typeof map[name] === 'string') {
				map[name] = map[name].replace(/\$(\w+)/, function(g0, g1) {
					return process.env[g1];
				});
			}
		}
	}
};

module.exports = Loader;
