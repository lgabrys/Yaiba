tinymce.ThemeManager.add("modern",function(e){function t(){function t(t){var i,o=[];if(t){var r=0,a=($("#mceToolbar").width()-40,!1);return d(t.split(/[ ,]/),function(t){function n(){var n=e.selection;"bullist"==l&&n.selectorChanged("ul > li",function(e,n){for(var i,o=n.parents.length;o--&&(i=n.parents[o].nodeName,"OL"!=i&&"UL"!=i););t.active(e&&"UL"==i)}),"numlist"==l&&n.selectorChanged("ol > li",function(e,n){for(var i,o=n.parents.length;o--&&(i=n.parents[o].nodeName,"OL"!=i&&"UL"!=i););t.active(e&&"OL"==i)}),t.settings.stateSelector&&n.selectorChanged(t.settings.stateSelector,function(e){t.active(e)},!0),"leanote_code"!=l&&(t.settings.disabledStateSelector="pre",n.selectorChanged(t.settings.disabledStateSelector,function(e){t.disabled(e)}))}var l;if("|"==t)i=null,a=!0;else if(c.has(t))t={type:t},u.toolbar_items_size&&(t.size=u.toolbar_items_size),o.push(t),i=null;else if(e.buttons[t]){l=t,t=e.buttons[l],"function"==typeof t&&(t=t()),t.type=t.type||"button",u.toolbar_items_size&&(t.size=u.toolbar_items_size),t=c.create(t),r++;var s=($("#popularToolbar").width(),t.renderHtml());a&&($("#popularToolbar").append('<span class="tool-split">|</span>'),a=!1),$("#popularToolbar").append(s),t.postRender(),e.initialized?n():e.on("init",n)}}),n.push({type:"toolbar",layout:"flow",items:o}),!0}}for(var n=[],i=1;10>i&&t(u["toolbar"+i]);i++);return n.length||t(u.toolbar||f),n}function n(){function t(t){var n;return"|"==t?{text:"|"}:n=e.menuItems[t]}function n(n){var i,o,r,a,l;if(l=tinymce.makeMap((u.removed_menuitems||"").split(/[ ,]/)),u.menu?(o=u.menu[n],a=!0):o=h[n],o){i={text:o.title},r=[],d((o.items||"").split(/[ ,]/),function(e){var n=t(e);n&&!l[e]&&r.push(t(e))}),a||d(e.menuItems,function(e){e.context==n&&("before"==e.separator&&r.push({text:"|"}),e.prependToContext?r.unshift(e):r.push(e),"after"==e.separator&&r.push({text:"|"}))});for(var s=0;s<r.length;s++)"|"==r[s].text&&(0===s||s==r.length-1)&&r.splice(s,1);if(i.menu=r,!i.menu.length)return null}return i}var i,o=[],r=[];if(u.menu)for(i in u.menu)r.push(i);else for(i in h)r.push(i);for(var a="string"==typeof u.menubar?u.menubar.split(/[ ,]/):r,l=0;l<a.length;l++){var s=a[l];s=n(s),s&&o.push(s)}return o}function i(t){function n(e){var n=t.find(e)[0];n&&n.focus()}e.shortcuts.add("Alt+F9","",function(){n("menubar")}),e.shortcuts.add("Alt+F10","",function(){n("toolbar")}),e.shortcuts.add("Alt+F11","",function(){n("elementpath")}),t.on("cancel",function(){e.focus()})}function o(t,n){function i(e){return{width:e.clientWidth,height:e.clientHeight}}var o,r,a,l;o=e.getContainer(),r=e.getContentAreaContainer().firstChild,a=i(o),l=i(r),null!==t&&(t=Math.max(u.min_width||100,t),t=Math.min(u.max_width||65535,t),m.css(o,"width",t+(a.width-l.width)),m.css(r,"width",t)),n=Math.max(u.min_height||100,n),n=Math.min(u.max_height||65535,n),m.css(r,"height",n),e.fire("ResizeEditor")}function r(t,n){var i=e.getContentAreaContainer();s.resizeTo(i.clientWidth+t,i.clientHeight+n)}function a(){function o(){if(d&&d.moveRel&&d.visible()&&!d._fixed){var t=e.selection.getScrollContainer(),n=e.getBody(),i=0,o=0;if(t){var r=m.getPos(n),a=m.getPos(t);i=Math.max(0,a.x-r.x),o=Math.max(0,a.y-r.y)}d.fixed(!1).moveRel(n,e.rtl?["tr-br","br-tr"]:["tl-bl","bl-tl"]).moveBy(i,o)}}function r(){d&&(d.show(),o(),m.addClass(e.getBody(),"mce-edit-focus"))}function a(){d&&(d.hide(),m.removeClass(e.getBody(),"mce-edit-focus"))}function l(){return d?void(d.visible()||r()):(d=s.panel=c.create({type:h?"panel":"floatpanel",classes:"tinymce tinymce-inline",layout:"flex",direction:"column",align:"stretch",autohide:!1,autofix:!0,fixed:!!h,border:1,items:[u.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:n()},u.toolbar===!1?null:{type:"panel",name:"toolbar",layout:"stack",items:t()}]}),d.renderTo(h||document.body).reflow(),i(d),r(),e.on("nodeChange",o),e.on("activate",r),void e.on("deactivate",a))}var d,h;return u.fixed_toolbar_container&&(h=m.select(u.fixed_toolbar_container)[0]),u.content_editable=!0,setTimeout(function(){l()}),e.on("focus",l),e.on("remove",function(){d&&(d.remove(),d=null)}),{}}function l(r){var a,l,d,m='<div id="noteTitleDiv"><input name="noteTitle" id="noteTitle" placeholder="Title" ></div>';m="",t();var h=[u.menubar===!1?null:{type:"menubar",border:"0 0 1 0",items:n()},null,{type:"panel",name:"iframe",layout:"stack",classes:"edit-area ifr",html:m,border:"1 0 0 0"}];return a=s.panel=c.create({type:"panel",classes:"tinymce",style:"visibility: hidden",layout:"stack",border:1,items:h}),u.resize!==!1&&(l={type:"resizehandle",direction:u.resize,onResizeStart:function(){var t=e.getContentAreaContainer().firstChild;d={width:t.clientWidth,height:t.clientHeight}},onResize:function(e){"both"==u.resize?o(d.width+e.deltaX,d.height+e.deltaY):o(null,d.height+e.deltaY)}}),u.statusbar!==!1&&a.add({type:"panel",name:"statusbar",classes:"statusbar",layout:"flow",border:"1 0 0 0",items:[{type:"elementpath"},l]}),u.readonly&&a.find("*").disabled(!0),a.renderBefore(r.targetNode).reflow(),u.width&&tinymce.DOM.setStyle(a.getEl(),"width",u.width),e.on("remove",function(){a.remove(),a=null}),i(a),{iframeContainer:a.find("#iframe")[0].getEl(),editorContainer:a.getEl()}}var s=this,u=e.settings,c=tinymce.ui.Factory,d=tinymce.each,m=tinymce.DOM,h={file:{title:"File",items:"newdocument"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall"},insert:{title:"Insert",items:"|"},view:{title:"View",items:"visualaid |"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript | formats | removeformat"},table:{title:"Table"},tools:{title:"Tools"}},f="undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image";s.renderUI=function(t){u.skin!==!1?u.skin||"lightgray":!1;return e.on("ProgressState",function(e){s.throbber=s.throbber||new tinymce.ui.Throbber(s.panel.getEl("body")),e.state?s.throbber.show(e.time):s.throbber.hide()}),u.inline?a(t):l(t)},s.resizeTo=o,s.resizeBy=r});